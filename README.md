# einvoice_check
这段 Python 代码主要实现了对 PDF 发票文件的信息提取、校验以及文件重命名的功能。它能够从 PDF 发票文件中提取诸如发票代码、号码、金额等关键信息，并根据提取的信息对发票文件进行重命名，方便后续的整理与管理，同时还会将提取到的发票信息整理保存到 Excel 文件中。

1. check_credit_code 函数
该函数用于校验给定的代码（可能是发票相关的校验码等）是否符合特定规则。
函数参数：
code：表示需要校验的代码字符串，它应该是由数字和特定字母组成的字符串。
函数内部逻辑：
首先定义了一个字典 codeDict，用于将字符（数字和特定字母）映射为对应的整数值，方便后续计算。
定义了一个权重列表 weights，长度为 17，用于在校验计算时与代码对应位置的字符值相乘。
通过循环遍历代码字符串（除最后一位），将每个字符对应的数值乘以相应权重后累加到 sum 变量中。
计算 mod 的值，它是基于 sum 按照特定算法（31 减去 sum 除以 31 的余数）得出的结果。
最后，通过比较 mod 和代码最后一位对应的数值（通过 codeDict 获取），如果满足特定相等条件（mod 等于最后一位对应的数值或者 mod 为 31 且最后一位对应数值为 0），则返回 True，表示校验通过，否则返回 False。

2. pdf_invoice 函数
这个函数用于处理指定文件夹下的所有 PDF 发票文件，提取关键信息并整理到 Excel 文件中。
函数参数：
pdf_folder_path：表示存放 PDF 发票文件的文件夹路径。
函数内部逻辑：
首先初始化两个列表，all_data 用于存储从各个发票文件中提取的信息，headers 定义了最终 Excel 文件中各列的表头信息。
通过列表推导式获取指定文件夹下所有以 .pdf 结尾的文件路径列表 pdf_files。
对于每个 PDF 文件：
先将 PDF 的第一页转换为图片（取第一页），然后对图片进行裁剪（裁剪到原图片宽高的四分之一大小），目的可能是聚焦到包含关键信息的区域（比如二维码所在区域等）。
从裁剪后的图片中提取二维码信息，将解码后的数据按逗号分割成列表 text_list，并取其中部分元素（从索引 1 开始的几个元素）作为发票相关的基础数据存到 data 列表中。
接着尝试从 PDF 文件中提取销售方信息，通过 pypdf 库读取 PDF 第一页文本内容，经过一系列字符串处理（替换、按行分割、筛选包含 “公司” 但不包含 “银行” 的行等操作），获取销售方名称并添加到 data 列表中，如果提取过程出现异常，则打印提示信息并在 data 列表中添加空字符串作为占位。
将文件名添加到 data 列表的首位，并把这个包含完整发票信息的 data 列表添加到 all_data 列表中。
最后，使用 pandas 库将 all_data 列表转换为 DataFrame 对象（按照定义好的表头 headers），并根据发票种类代码判断是否为电子发票（普通发票）来处理含税金额列（如果不是 32 则将该列对应单元格设为 None），最终将整理好的数据保存到名为 发票信息.xlsx 的 Excel 文件中（不包含索引列）。

3. rename 函数
该函数用于根据从发票信息 Excel 文件中读取的信息来重命名发票文件，并将其复制到新的文件夹下。
函数参数：
user_name：表示要添加到新文件名中的用户名信息，用于进一步区分文件所属等情况。
old_file_folder：存放原始发票 PDF 文件的文件夹路径。
new_file_folder：重命名后的发票文件要复制到的目标文件夹路径。
函数内部逻辑：
首先通过 pandas 库读取之前生成的 发票信息.xlsx 文件内容到 DataFrame 对象 df 中。
然后遍历 DataFrame 的每一行，根据行中的文件名、销售方、发票号码、含税金额以及传入的用户名信息来构造新的文件名 new_name，同时构造原始文件名 old_name（在原文件名基础上加 .pdf 后缀）以及对应的原始文件路径 old_file_path 和新文件路径 new_file_path。
最后使用 shutil.copy 函数将原始文件从旧路径复制到新路径，实现文件重命名并移动到新文件夹的功能（实际上是复制，原文件依然存在于旧文件夹中）。
